using System;
using System.Collections.Generic;
using System.Linq;
using System.Security.Cryptography;
using MGroup.MSolve.Discretization.Entities;
using MGroup.MSolve.Discretization.Dofs;
using MGroup.MSolve.Numerics.Interpolation.Jacobians;
using MGroup.DrugDeliveryModel.Tests.EquationModels;
using MGroup.NumericalAnalyzers.Dynamic;
using MGroup.NumericalAnalyzers.Logging;
using MGroup.NumericalAnalyzers.Staggered;
using MGroup.NumericalAnalyzers.Discretization.NonLinear;
using MGroup.Constitutive.Structural;
using MGroup.DrugDeliveryModel.Tests.Commons;
using MGroup.NumericalAnalyzers;
using MGroup.Solvers.Direct;
using Xunit;
using MGroup.Constitutive.ConvectionDiffusion;
using MGroup.Constitutive.ConvectionDiffusion.BoundaryConditions;
using MGroup.Constitutive.ConvectionDiffusion.InitialConditions;
using System.Diagnostics;

namespace MGroup.DrugDeliveryModel.Tests.Integration
{
    public class EquationsTests13DistributedModelBuilderCox
    {
        //---------------------------------------Equation Cox---------------------------------------

        //---------------------------------------Variables------------------------------------------
        /// <summary>
        /// The average value of the three components of the fluid velocity vector  [m/s]
        /// </summary>
        private Dictionary<int, double[]> FluidSpeed = new Dictionary<int, double[]>(); // 2.32E-4 [m/s]
        double FluidInit = 2.32;
        /// <summary>
        /// Diffusivity of oxygen [m2/s]
        /// </summary>
        private const double Dox = 1.79E-4; // [m2/s]

        /// <summary>
        /// Oxygen uptake [mol/(m3*s)]
        /// </summary>
        private const double Aox = 2.5463E-2; // [mol/(m3*s)]

        /// <summary>
        /// Oxygen uptake [mol/m3]
        /// </summary>
        private const double Kox = 4.64E-3; // [mol / m3]

        /// <summary>
        /// Oxygen permeability across tumor vessel walls [m/s]
        /// </summary>
        private const double PerOx = 3.55E-4; // [m/s]

        /// <summary>
        /// Vascular Density [1/m]
        /// </summary>
        private const double Sv = 7E3; // [1/m]


        private const double CiOx = 0.2; // [mol/m3]
        
        /// <summary>
        /// Initial Oxygen Concentration [mol/m3]
        /// </summary>
        private const double CoxInitialCondition = 0.0; // [mol/m3]
        /// <summary>
        /// Cancer cell density [1]
        /// </summary>
        private Dictionary<int, double> T = new Dictionary<int, double>();// 500 [cells]

        //---------------------------------------Logging----------------------------------
        /// <summary>
        /// The degree of freedom that will be monitored for equation cox
        /// </summary>
        private ConvectionDiffusionDof coxMonitorDOF = ConvectionDiffusionDof.UnknownVariable;

        /// <summary>
        /// The coordinates of the monitored node
        /// </summary>
        private double[] monitorNodeCoords = { 0.09, 0.0, 0.05 };


        //---------------------------------------Time Discretization Specs------------------------------
        private const double TotalTime = 10E-5;

        /// <summary>
        /// For increased accuracy use time-step of order 1E-5
        /// </summary>
        private const double TimeStep = 1E-5;// sec

        /// <summary>
        /// Simplified version of the production term without non-linear term
        /// </summary>

        private readonly Func<double> independentLinearSource = () => PerOx * Sv * CiOx;

        static double[] expectedLinSolution = new double[]
            {-0.0002105373125587959, -0.0003133024869569006, -0.0004141663915288726, -0.0005129763178853869, -0.0006096861342003591, -0.0007042852696518675, -0.000796775015903482, -0.0008871606186806564, -0.0009754486386300758, -0.0010616460705799, -0.0011457600495923, -0.0012277977528317, -0.0013077663667799, -0.0013856730762568, -0.0014615250607187, -0.001535329492985, -0.0016070935387757, -0.0016768243565195, -0.0017445290972526, -0.0018102149045475, -0.0018738889144529, -0.0019355582554366, -0.0019952300483297, -0.0020529114062723, -0.0021086094346591, -0.0021623312310847, -0.0022140838852908, -0.0022638744791122, -0.0023117100864235, -0.002357597773087, -0.0024015445968996, -0.0024435576075406, -0.0024836438465199, -0.0025218103471266, -0.0025580641343773, -0.0025924122249651, -0.0026248616272091, -0.0026554193410037, -0.0026840923577687, -0.0027108876603993, -0.0027358122232166, -0.0027588730119183, -0.0027800769835298, -0.0027994310863556, -0.0028169422599309, -0.0028326174349734, -0.0028464635333357, -0.0028584874679578, -0.0028686961428199, -0.0028770964528957, -0.0028836952841052, -0.0028884995132695, -0.0028915160080635, -0.0028927516269715, -0.0028922132192408, -0.0028899076248369, -0.0028858416743992, -0.0028800221891956, -0.002872455981079, -0.0028631498524429, -0.002852110596178, -0.002839344995629, -0.0028248598245511, -0.0028086618470676, -0.0027907578176274, -0.0027711544809627, -0.0027498585720472, -0.0027268768160546, -0.0027022159283171, -0.0026758826142845, -0.0026478835694834, -0.0026182254794772, -0.0025869150198252, -0.0025539588560435, -0.002519363643565, -0.0024831360277003, -0.0024452826435988, -0.0024058101162096, -0.0023647250602439, -0.0023220340801361, -0.0022777437700062, -0.0022318607136227, -0.0021843914843647, -0.0021353426451856, -0.0020847207485757, -0.0020325323365265, -0.0019787839404943, -0.0019234820813643, -0.0018666332694151, -0.0018082440042839, -0.0017483207749308, -0.0016868700596048, -0.0016238983258088, -0.0015594120302662, -0.0014934176188866, -0.0014259215267321, -0.0013569301779847, -0.0012864499859127, -0.0012144873528385, -0.0011410486701057, -0.0010661403180473, -0.0009897686659539333, -0.0009119400720419426, -0.000832660883422442, -0.0007519374360701376, -0.0006697760547926398, -0.0005861830532000165, -0.000501164733674627, -0.0004147273873412234, -0.0003268772940373496, -0.00023762072228399777, -0.00014696392925655217, -5.491316075600607e-05, 3.852534881954471e-05, 0.00013334537650313283, 0.00022954071078687557, 0.0003271051516496538, 0.0004260325105845283, 0.0005263166106258601, 0.0006279512863761797, 0.0007309303840327721, 0.0008352477614139923, 0.0009408972879853082, 0.001047872844885, 0.00115616832495, 0.0012657776327405, 0.0013766946845654, 0.0014889134085071, 0.0016024277444453, 0.0017172316440818, 0.001833319070964, 0.0019506840005088, 0.0020693204200256, 0.0021892223287397, 0.0023103837378151, 0.0024327986703766, 0.0025564611615329, 0.0026813652583977, 0.0028075050201122, 0.0029348745178663, 0.0030634678349197, 0.0031932790666232, 0.0033243023204389, 0.0034565317159615, 0.0035899613849373, 0.0037245854712853, 0.003860398131116, 0.0039973935327514, 0.0041355658567437, 0.0042749092958945, 0.0044154180552731, 0.0045570863522353, 0.0046999084164413, 0.0048438784898734, 0.0049889908268537, 0.0051352396940619, 0.0052826193705516, 0.0054311241477677, 0.0055807483295629, 0.0057314862322138, 0.0058833321844373, 0.0060362805274063, 0.0061903256147652, 0.0063454618126454, 0.00650168349968, 0.0066589850670192, 0.0068173609183446, 0.0069768054698833, 0.0071373131504226, 0.007298878401323, 0.0074614956765326, 0.0076251594425999, 0.0077898641786874, 0.0079556043765839, 0.0081223745407174, 0.0082901691881676, 0.008458982848678, 0.0086288100646673, 0.0087996453912417, 0.0089714833962062, 0.0091443186600752, 0.0093181457760841, 0.0094929593501998, 0.0096687540011309, 0.0098455243603381, 0.0100232650720443, 0.0102019707932441, 0.0103816361937135, 0.010562255956019, 0.0107438247755269, 0.0109263373604116, 0.0111097884316649, 0.0112941727231037, 0.0114794849813783, 0.0116657199659805, 0.0118528724492509, 0.0120409372163866, 0.0122299090654483, 0.012419782807367, 0.0126105532659513, 0.0128022152778932, 0.012994763692775, 0.013188193373075, 0.0133824991941735, 0.0135776760443581, 0.0137737188248297, 0.0139706224497068, 0.0141683818460312, 0.0143669919537724, 0.014566447725832, 0.0147667441280482, 0.0149678761391995, 0.0151698387510091, 0.0153726269681479, 0.0155762358082383, 0.0157806603018574, 0.0159858954925396, 0.0161919364367798, 0.0163987782040355, 0.0166064158767297, 0.0168148445502523, 0.0170240593329625, 0.0172340553461906, 0.0174448277242389, 0.0176563716143834, 0.0178686821768748, 0.0180817545849394, 0.0182955840247795, 0.0185101656955741, 0.018725494809479, 0.0189415665916267, 0.0191583762801265, 0.0193759191260641, 0.0195941903935006, 0.0198131853594722, 0.0200328993139888, 0.0202533275600334, 0.0204744654135598, 0.0206963082034918, 0.0209188512717213, 0.0211420899731056, 0.0213660196754663, 0.021590635759586, 0.0218159336192061, 0.0220419086610242, 0.0222685563046908, 0.022495871982806, 0.0227238511409169, 0.0229524892375132, 0.0231817817440238, 0.0234117241448131, 0.0236423119371764, 0.023873540631336, 0.0241054057504364, 0.0243379028305399, 0.0245710274206216, 0.0248047750825641, 0.0250391413911526, 0.0252741219340694, 0.0255097123118882, 0.0257459081380682, 0.0259827050389485, 0.0262200986537415, 0.0264580846345267, 0.0266966586462445, 0.0269358163666891, 0.0271755534865017, 0.0274158657091635, 0.0276567487509887, 0.0278981983411166, 0.0281402102215043, 0.0283827801469192, 0.0286259038849306, 0.0288695772159018, 0.0291137959329819, 0.0293585558420971, 0.0296038527619427, 0.0298496825239733, 0.0300960409723949, 0.0303429239641551, 0.0305903273689342, 0.0308382470691352, 0.0310866789598749, 0.0313356189489737, 0.0315850629569456, 0.0318350069169882, 0.0320854467749727, 0.0323363784894328, 0.0325877980315549, 0.0328397013851666, 0.0330920845467263, 0.0333449435253119, 0.0335982743426098, 0.0338520730329032, 0.0341063356430606, 0.0343610582325244, 0.0346162368732987, 0.0348718676499376, 0.0351279466595328, 0.0353844700117014, 0.0356414338285733, 0.035898834244779, 0.0361566674074363, 0.0364149294761377, 0.0366736166229373, 0.0369327250323377, 0.0371922509012764, 0.0374521904391125, 0.0377125398676129, 0.0379732954209389, 0.0382344533456317, 0.0384960099005988, 0.0387579613570996, 0.0390203039987312, 0.0392830341214135, 0.0395461480333753, 0.0398096420551386, 0.0400735125195047, 0.0403377557715383, 0.040602368168553, 0.0408673460800954, 0.0411326858879302, 0.0413983839860244, 0.0416644367805312, 0.0419308406897751, 0.042197592144235, 0.0424646875865285, 0.0427321234713958, 0.0429998962656831, 0.0432680024483264, 0.0435364385103344, 0.0438052009547725, 0.0440742862967451, 0.0443436910633794, 0.0446134117938077, 0.0448834450391507, 0.0451537873624996, 0.045424435338899, 0.0456953855553293, 0.0459666346106889, 0.0462381791157764, 0.0465100156932726, 0.0467821409777225, 0.0470545516155172, 0.0473272442648754, 0.0476002155958254, 0.0478734622901861, 0.0481469810415486, 0.0484207685552577, 0.0486948215483924, 0.0489691367497477, 0.0492437108998151, 0.0495185407507634, 0.0497936230664197, 0.0500689546222498, 0.0503445322053386, 0.0506203526143707, 0.0508964126596107, 0.0511727091628834, 0.0514492389575537, 0.0517259988885067, 0.0520029858121276, 0.0522801965962816, 0.0525576281202934, 0.0528352772749269, 0.0531131409623645, 0.053391216096187, 0.0536694996013521, 0.0539479884141744, 0.0542266794823041, 0.0545055697647061, 0.0547846562316388, 0.0550639358646332, 0.0553434056564713, 0.0556230626111652, 0.0559029037439352, 0.0561829260811886, 0.0564631266604978, 0.056743502530579, 0.05702405075127, 0.0573047683935087, 0.0575856525393106, 0.0578667002817475, 0.0581479087249247, 0.0584292749839594, 0.0587107961849577, 0.058992469464993, 0.0592742919720829, 0.0595562608651672, 0.0598383733140848, 0.0601206264995515, 0.0604030176131369, 0.0606855438572418, 0.060968202445075, 0.0612509906006307, 0.061533905558665, 0.0618169445646732, 0.0621001048748665, 0.0623833837561483, 0.0626667784860916, 0.0629502863529149, 0.0632339046554593, 0.0635176307031643, 0.063801461816045, 0.0640853953246675, 0.0643694285701262, 0.0646535589040189, 0.0649377836884238, 0.0652221002958751, 0.0655065061093392, 0.0657909985221903, 0.066075574938187, 0.0663602327714474, 0.066644969446425, 0.0669297823978849, 0.0672146690708788, 0.067499626920721, 0.0677846534129636, 0.0680697460233726, 0.0683549022379025, 0.0686401195526722, 0.0689253954739403, 0.0692107275180802, 0.0694961132115552, 0.0697815500908942, 0.0700670357026661, 0.0703525676034554, 0.0706381433598369, 0.0709237605483509, 0.0712094167554782, 0.0714951095776143, 0.0717808366210453, 0.0720665955019216, 0.0723523838462335, 0.0726381992897854, 0.0729240394781707, 0.0732099020667463, 0.0734957847206071, 0.0737816851145607, 0.074067600933102, 0.0743535298703872, 0.0746394696302087, 0.0749254179259692, 0.0752113724806562, 0.0754973310268162, 0.0757832913065291, 0.0760692510713823, 0.0763552080824449, 0.0766411601102421, 0.0769271049347291, 0.0772130403452653, 0.0774989641405885, 0.0777848741287887, 0.0780707681272824, 0.0783566439627863, 0.0786424994712915, 0.0789283324980374, 0.0792141408974856, 0.0794999225332937, 0.0797856752782893, 0.0800713970144438, 0.0803570856328461, 0.0806427390336766, 0.0809283551261808, 0.0812139318286431, 0.0814994670683606, 0.0817849587816169, 0.0820704049136553, 0.0823558034186532, 0.0826411522596953, 0.082926449408747, 0.0832116928466289, 0.0834968805629896, 0.0837820105562794, 0.0840670808337242, 0.084352089411299, 0.0846370343137013, 0.0849219135743246, 0.0852067252352321, 0.0854914673471301, 0.0857761379693417, 0.08606073516978, 0.086345257024922, 0.0866297016197815, 0.0869140670478831, 0.0871983514112355, 0.0874825528203049, 0.0877666693939886, 0.0880506992595881, 0.0883346405527831, 0.0886184914176045, 0.0889022500064079, 0.0891859144798476, 0.0894694830068489, 0.0897529537645827, 0.0900363249384383, 0.090319594721997, 0.0906027613170056, 0.0908858229333496, 0.0911687777890271, 0.0914516241101216, 0.0917343601307762, 0.0920169840931664, 0.092299494247474, 0.0925818888518604, 0.0928641661724399, 0.0931463244832536, 0.0934283620662424, 0.093710277211221, 0.0939920682158509, 0.0942737333856143, 0.0945552710337875, 0.0948366794814142, 0.0951179570572795, 0.0953991020978832, 0.0956801129474131, 0.0959609879577193, 0.096241725488287, 0.0965223239062106, 0.0968027815861672, 0.0970830969103902, 0.0973632682686431, 0.0976432940581929, 0.097923172683784, 0.098202902557612, 0.0984824820992971, 0.0987619097358582, 0.0990411839016862, 0.0993203030385184, 0.0995992655954118, 0.0998780700287172, 0.1001567148020529, 0.1004351983862785, 0.1007135192594693, 0.1009916759068893, 0.1012696668209661, 0.1015474905012643, 0.1018251454544595, 0.1021026301943126, 0.1023799432416437, 0.1026570831243059, 0.10293404837716, 0.103210837542048, 0.1034874491677676, 0.1037638818100463, 0.1040401340315157, 0.1043162044016855, 0.104592091496918, 0.1048677939004023, 0.1051433102021287, 0.105418638998863, 0.1056937788941208, 0.1059687284981422, 0.1062434864278661, 0.1065180513069047, 0.1067924217655179, 0.1070665964405882, 0.1073405739755951, 0.1076143530205896, 0.1078879322321691, 0.1081613102734523, 0.1084344858140533, 0.108707457530057, 0.1089802241039936, 0.1092527842248139, 0.1095251365878635, 0.1097972798948583, 0.1100692128538595, 0.110340934179248, 0.1106124425917004, 0.1108837368181635, 0.1111548155918294, 0.1114256776521111, 0.1116963217446174, 0.1119667466211285, 0.1122369510395709, 0.1125069337639933, 0.1127766935645415, 0.1130462292174341, 0.1133155395049382, 0.1135846232153448, 0.113853479142944, 0.1141221060880015, 0.1143905028567335, 0.114658668261283, 0.1149266011196952, 0.1151943002558936, 0.1154617644996559, 0.1157289926865896, 0.1159959836581086, 0.1162627362614086, 0.1165292493494438, 0.1167955217809025, 0.1170615524201836, 0.1173273401373731, 0.1175928838082196, 0.1178581823141117, 0.1181232345420536, 0.118388039384642, 0.1186525957400423, 0.1189169025119656, 0.119180958609645, 0.1194447629478123, 0.1197083144466751, 0.119971612031893, 0.120234654634555, 0.1204974411911562, 0.1207599706435748, 0.121022241939049, 0.1212842540301544, 0.1215460058747808, 0.1218074964361097, 0.1220687246825912, 0.1223296895879218, 0.1225903901310215, 0.1228508252960113, 0.1231109940721905, 0.1233708954540148, 0.1236305284410734, 0.1238898920380669, 0.1241489852547851, 0.1244078071060847, 0.1246663566118675, 0.1249246327970578, 0.1251826346915808, 0.1254403613303406, 0.1256978117531984, 0.1259549850049504, 0.1262118801353063, 0.1264684961988679, 0.1267248322551069, 0.1269808873683438, 0.1272366606077261, 0.1274921510472073, 0.1277473577655253, 0.1280022798461811, 0.1282569163774177, 0.1285112664521989, 0.1287653291681884, 0.1290191036277284, 0.129272588937819, 0.1295257842100974, 0.1297786885608169, 0.1300313011108261, 0.1302836209855485, 0.1305356473149617, 0.1307873792335771, 0.1310388158804193, 0.1312899563990055, 0.1315407999373257, 0.1317913456478222, 0.1320415926873693, 0.1322915402172534, 0.132541187403153, 0.1327905334151185, 0.1330395774275528, 0.1332883186191908, 0.1335367561730806, 0.1337848892765627, 0.1340327171212516, 0.1342802389030152, 0.1345274538219563, 0.1347743610823927, 0.1350209598928378, 0.1352672494659819, 0.1355132290186727, 0.1357588977718963, 0.1360042549507581, 0.1362492997844641, 0.136494031506302, 0.1367384493536224, 0.1369825525678201, 0.1372263403943154, 0.1374698120825358, 0.1377129668858973, 0.1379558040617861, 0.1381983228715406, 0.1384405225804324, 0.1386824024576491, 0.1389239617762755, 0.1391651998132759, 0.1394061158494761, 0.1396467091695458, 0.1398869790619804, 0.1401269248190836, 0.1403665457369498, 0.1406058411154465, 0.1408448102581969, 0.1410834524725624, 0.1413217670696253, 0.1415597533641721, 0.1417974106746753, 0.1420347383232777, 0.1422717356357741, 0.1425084019415953, 0.1427447365737911, 0.1429807388690133, 0.1432164081674992, 0.1434517438130551, 0.1436867451530397, 0.1439214115383478, 0.1441557423233937, 0.1443897368660952, 0.1446233945278575, 0.1448567146735568, 0.1450896966715244, 0.145322339893531, 0.1455546437147705, 0.1457866075138444, 0.1460182306727462, 0.1462495125768456, 0.1464804526148732, 0.1467110501789047, 0.146941304664346, 0.1471712154699176, 0.1474007819976394, 0.1476300036528157, 0.1478588798440202, 0.1480874099830809, 0.1483155934850655, 0.1485434297682662, 0.1487709182541852, 0.1489980583675202, 0.1492248495361497, 0.1494512911911188, 0.1496773827666241, 0.1499031237000005, 0.150128513431706, 0.1503535514053081, 0.1505782370674697, 0.1508025698679349, 0.1510265492595154, 0.1512501746980767, 0.1514734456425239, 0.1516963615547888, 0.1519189218998159, 0.1521411261455488, 0.1523629737629172, 0.1525844642258235, 0.1528055970111295, 0.153026371598643, 0.1532467874711053, 0.1534668441141779, 0.1536865410164296, 0.1539058776693239, 0.1541248535672059, 0.1543434682072901, 0.1545617210896475, 0.1547796117171935, 0.154997139595675, 0.1552143042336586, 0.155431105142518, 0.1556475418364221, 0.1558636138323229, 0.1560793206499433, 0.1562946618117656, 0.1565096368430194, 0.1567242452716698, 0.1569384866284062, 0.1571523604466301, 0.1573658662624443, 0.157579003614641, 0.1577917720446907, 0.1580041710967309, 0.1582162003175551, 0.1584278592566013, 0.1586391474659417, 0.1588500645002712, 0.1590606099168971, 0.1592707832757276, 0.159480584139262, 0.1596900120725798, 0.1598990666433298, 0.1601077474217204, 0.1603160539805087, 0.1605239858949906, 0.1607315427429905, 0.1609387241048512, 0.1611455295634241, 0.1613519587040589, 0.1615580111145942, 0.1617636863853473, 0.1619689841091049, 0.1621739038811135, 0.1623784452990696, 0.1625826079631103, 0.1627863914758044, 0.1629897954421425, 0.1631928194695283, 0.1633954631677694, 0.1635977261490681, 0.1637996080280123, 0.1640011084215673, 0.1642022269490664, 0.1644029632322023, 0.1646033168950188, 0.1648032875639018, 0.1650028748675713, 0.1652020784370723, 0.1654008979057676, 0.1655993329093284, 0.1657973830857271, 0.1659950480752285, 0.1661923275203823, 0.166389221066015, 0.166585728359222, 0.1667818490493601, 0.1669775827880396, 0.1671729292291165, 0.1673678880286857, 0.1675624588450729, 0.1677566413388272, 0.1679504351727144, 0.1681438400117094, 0.1683368555229889, 0.1685294813759248, 0.1687217172420768, 0.1689135627951858, 0.169105017711167, 0.1692960816681031, 0.1694867543462375, 0.169677035427968, 0.1698669245978403, 0.170056421542541, 0.1702455259508919, 0.1704342375138435, 0.1706225559244685, 0.1708104808779562, 0.1709980120716057, 0.1711851492048207, 0.1713718919791031, 0.1715582400980474, 0.1717441932673344, 0.1719297511947265, 0.1721149135900611, 0.1722996801652455, 0.1724840506342516, 0.17266802471311, 0.1728516021199053, 0.1730347825747702, 0.1732175657998808, 0.1733999515194512, 0.1735819394597287, 0.1737635293489888, 0.17394472091753, 0.1741255138976694, 0.1743059080237377, 0.1744859030320745, 0.1746654986610241, 0.1748446946509303, 0.1750234907441324, 0.1752018866849607, 0.1753798822197323, 0.1755574770967464, 0.1757346710662807, 0.1759114638805869, 0.1760878552938867, 0.1762638450623682, 0.1764394329441811, 0.176614618699434, 0.1767894020901898, 0.1769637828804623, 0.1771377608362123, 0.1773113357253448, 0.1774845073177043, 0.1776572753850725, 0.1778296397011642, 0.1780016000416244, 0.1781731561840246, 0.1783443079078604, 0.1785150549945476, 0.1786853972274194, 0.1788553343917239, 0.1790248662746205, 0.1791939926651776, 0.1793627133543694, 0.1795310281350733, 0.1796989368020676, 0.1798664391520284, 0.1800335349835274, 0.1802002240970294, 0.1803665062948897, 0.180532381381352, 0.1806978491625461, 0.1808629094464854, 0.1810275620430651, 0.1811918067640602, 0.1813556434231229, 0.1815190718357812, 0.1816820918194366, 0.1818447031933627, 0.182006905778703, 0.1821686993984692, 0.1823300838775399, 0.1824910590426586, 0.1826516247224323, 0.18281178074733, 0.1829715269496814, 0.1831308631636752, 0.1832897892253582, 0.1834483049726337, 0.1836064102452604, 0.1837641048848512, 0.1839213887348726, 0.1840782616406426, 0.184234723449331, 0.1843907740099575, 0.1845464131733913, 0.1847016407923502, 0.1848564567213997, 0.1850108608169526, 0.185164852937268, 0.1853184329424511, 0.1854716006944521, 0.1856243560570664, 0.1857766988959337, 0.1859286290785376, 0.1860801464742056, 0.1862312509541084, 0.1863819423912602, 0.186532220660518, 0.1866820856385817, 0.1868315372039941, 0.1869805752371408, 0.1871291996202502, 0.1872774102373937, 0.1874252069744856, 0.1875725897192833, 0.1877195583613879, 0.1878661127922441, 0.1880122529051405, 0.1881579785952102, 0.1883032897594311, 0.1884481862966262, 0.1885926681074645, 0.1887367350944611, 0.1888803871619782, 0.1890236242162254, 0.1891664461652608, 0.1893088529189911, 0.1894508443891732, 0.1895924204894142, 0.1897335811351731, 0.1898743262437609, 0.1900146557343422, 0.1901545695279357, 0.1902940675474156, 0.1904331497175126, 0.190571815964815, 0.1907100662177697, 0.1908479004066837, 0.1909853184637251, 0.1911223203229247, 0.191258905920177, 0.1913950751932417, 0.191530828081745, 0.1916661645271814, 0.1918010844729148, 0.1919355878641804, 0.1920696746480857, 0.1922033447736126, 0.1923365981916189, 0.19246943485484, 0.1926018547178906, 0.1927338577372662, 0.1928654438713455, 0.1929966130803914, 0.1931273653265536, 0.1932577005738701, 0.1933876187882692, 0.1935171199375714, 0.1936462039914917, 0.1937748709216412, 0.1939031207015292, 0.1940309533065659, 0.1941583687140637, 0.19428536690324, 0.1944119478552189, 0.1945381115530338, 0.1946638579816295, 0.1947891871278644, 0.1949140989805131, 0.1950385935302683, 0.1951626707697436, 0.1952863306934758, 0.1954095732979269, 0.1955323985814874, 0.1956548065444781, 0.1957767971891526, 0.1958983705197005, 0.1960195265422493, 0.1961402652648673, 0.1962605866975661, 0.1963804908523035, 0.1964999777429858, 0.1966190473854708, 0.1967376997975704, 0.1968559349990535, 0.1969737530116485, 0.1970911538590463, 0.197208137566903};    
        static double[] expectedNonLinSolution = new double[]
            {-0.0002577634612139296, -0.0003824929072089781, -0.0005041287202650932, -0.0006223680518233604, -0.0007371803097879908, -0.0008485826525510643, -0.0009566085241174244, -0.0010612972094087, -0.0011626904327479, -0.0012608313031664, -0.0013557640300061, -0.0014475338808293, -0.0015361872058396, -0.0016217714711329, -0.0017043352825885, -0.0017839283953091, -0.0018606017078018, -0.0019344072414479, -0.0020053981062035, -0.0020736284535778, -0.0021391534179488, -0.0022020290472786, -0.0022623122242912, -0.0023200605791849, -0.0023753323949599, -0.0024281865064569, -0.0024786821942082, -0.0025268790742091, -0.0025728369847168, -0.0026166158711677, -0.0026582756702897, -0.0026978761944507, -0.0027354770172447, -0.0027711373612651, -0.0028049159889523, -0.0028368710973323, -0.0028670602173842, -0.00289554011869, -0.0029223667199284, -0.0029475950056838, -0.0029712789499459, -0.00299347144658, -0.0030142242469578, -0.003033587904849, -0.0030516117285885, -0.0030683437404591, -0.003083830643154, -0.0030981177931242, -0.0031112491805564, -0.0031232674156824, -0.0031342137210804, -0.0031441279295981, -0.0031530484875047, -0.0031610124624635, -0.0031680555559069, -0.0031742121193948, -0.0031795151745385, -0.0031839964360835, -0.0031876863377504, -0.0031906140604573, -0.0031928075625557, -0.003194293611741, -0.0031950978183135, -0.0031952446694936, -0.003194757564515, -0.0031936588502453, -0.0031919698571059, -0.0031897109350848, -0.0031869014896599, -0.0031835600174704, -0.0031797041415931, -0.003175350646301, -0.0031705155111971, -0.0031652139446341, -0.0031594604163457, -0.0031532686892265, -0.0031466518502135, -0.0031396223402308, -0.0031321919831694, -0.0031243720138842, -0.0031161731051972, -0.003107605393903, -0.003098678505779, -0.0030894015796072, -0.0030797832902208, -0.0030698318705901, -0.0030595551329673, -0.0030489604891118, -0.0030380549696194, -0.0030268452423817, -0.0030153376302006, -0.0030035381275875, -0.002991452416775, -0.0029790858829683, -0.0029664436288675, -0.0029535304884879, -0.0029403510403071, -0.0029269096197679, -0.002913210331164, -0.0028992570589357, -0.0028850534784027, -0.002870603065959, -0.0028559091087555, -0.0028409747138946, -0.0028258028171594, -0.0028103961913014, -0.0027947574539066, -0.0027788890748633, -0.0027627933834487, -0.0027464725750559, -0.0027299287175787, -0.0027131637574707, -0.0026961795254977, -0.0026789777421974, -0.0026615600230618, -0.0026439278834581, -0.0026260827433006, -0.0026080259314864, -0.0025897586901094, -0.0025712821784614, -0.0025525974768341, -0.0025337055901316, -0.0025146074513029, -0.0024953039246049, -0.0024757958087049, -0.0024560838396305, -0.0024361686935755, -0.0024160509895693, -0.0023957312920178, -0.0023752101131211, -0.0023544879151764, -0.002333565112771, -0.0023124420748714, -0.0022911191268145, -0.0022695965522061, -0.0022478745947306, -0.0022259534598779, -0.0022038333165916, -0.0021815142988416, -0.0021589965071265, -0.0021362800099088, -0.002113364844986, -0.0020902510208023, -0.0020669385177023, -0.002043427289131, -0.0020197172627826, -0.0019958083416999, -0.0019717004053284, -0.001947393310526, -0.0019228868925312, -0.001898180965892, -0.0018732753253575, -0.0018481697467334, -0.0018228639877041, -0.001797357788623, -0.0017716508732718, -0.0017457429495908, -0.0017196337103823, -0.0016933228339875, -0.0016668099849381, -0.0016400948145846, -0.0016131769617024, -0.0015860560530756, -0.0015587317040611, -0.0015312035191329, -0.0015034710924077, -0.0014755340081533, -0.0014473918412795, -0.0014190441578136, -0.0013904905153598, -0.0013617304635448, -0.0013327635444484, -0.0013035892930215, -0.0012742072374912, -0.0012446168997529, -0.001214817795752, -0.0011848094358532, -0.0011545913251996, -0.0011241629640615, -0.0010935238481754, -0.0010626734690729, -0.0010316113144016, -0.0010003368682362, -0.0009688496113819304, -0.000937149021669496, -0.000905234574242558, -0.0008731057418374974, -0.0008407619950560975, -0.0008082028026312603, -0.0007754276316860232, -0.0007424359479861096, -0.0007092272161862357, -0.00067580090007038, -0.0006421564627862144, -0.0006082933670738804, -0.0005742110754892989, -0.0005399090506221664, -0.0005053867553088135, -0.0004706436528400536, -0.0004356792071642032, -0.0004004928830853672, -0.0003650841464571477, -0.0003294524643718876, -0.0002935973053455663, -0.0002575181394984602, -0.00022121443873166952, -0.00018468567689961448, -0.00014793132997859267, -0.00011095087623148989, -7.374379636872796e-05, -3.630957370553269e-05, 1.3523056844016489e-06, 3.9242352818776807e-05, 7.736107566001408e-05, 0.00011570897897196795, 0.00015428656417997558, 0.0001930943292341567, 0.00023213276847593785, 0.00027140237250772124, 0.0003109036280656537, 0.0003506370178954437, 0.0003906030206311767, 0.00043080211067708207, 0.0004712347580922065, 0.0005119014284779498, 0.0005528025828684216, 0.0005939386776235787, 0.0006353101643251027, 0.000676917489674983, 0.000718761095396766, 0.0007608414181394361, 0.0008031588893838936, 0.0008457139353520048, 0.0008885069769181676, 0.000931538429523394, 0.0009748087030918552, 0.0010183182019498, 0.0010620673247472, 0.0011060564643812, 0.0011502860079225, 0.0011947563365434, 0.0012394678254493, 0.0012844208438111, 0.0013296157547005, 0.001375052915028, 0.001420732675482, 0.001466655380471, 0.0015128213680675, 0.0015592309699541, 0.0016058845113716, 0.0016527823110698, 0.0016999246812591, 0.0017473119275652, 0.0017949443489857, 0.0018428222378478, 0.0018909458797692, 0.0019393155536198, 0.0019879315314862, 0.0020367940786372, 0.002085903453492, 0.0021352599075899, 0.0021848636855613, 0.0022347150251014, 0.0022848141569451, 0.0023351613048435, 0.0023857566855427, 0.0024366005087635, 0.0024876929771838, 0.0025390342864216, 0.00259062462502, 0.0026424641744343, 0.0026945531090198, 0.002746891596022, 0.0027994797955673, 0.0028523178606565, 0.0029054059371587, 0.002958744163807, 0.0030123326721958, 0.0030661715867795, 0.0031202610248721, 0.0031746010966491, 0.0032291919051493, 0.0032840335462798, 0.0033391261088205, 0.0033944696744309, 0.003450064317658, 0.003505910105945, 0.0035620070996419, 0.0036183553520166, 0.0036749549092673, 0.0037318058105367, 0.0037889080879261, 0.0038462617665119, 0.0039038668643618, 0.0039617233925536, 0.0040198313551934, 0.0040781907494359, 0.0041368015655056, 0.004195663786718, 0.0042547773895031, 0.0043141423434289, 0.0043737586112257, 0.0044336261488122, 0.004493744905321, 0.0045541148231267, 0.0046147358378728, 0.0046756078785014, 0.0047367308672819, 0.0047981047198417, 0.0048597293451968, 0.0049216046457838, 0.0049837305174916, 0.0050461068496951, 0.0051087335252884, 0.0051716104207187, 0.0052347374060219, 0.0052981143448573, 0.0053617410945439, 0.0054256175060966, 0.0054897434242638, 0.005554118687564, 0.0056187431283249, 0.005683616572721, 0.0057487388408129, 0.0058141097465867, 0.0058797290979937, 0.0059455966969904, 0.0060117123395795, 0.0060780758158505, 0.006144686910021, 0.0062115454004784, 0.0062786510598219, 0.0063460036549046, 0.0064136029468761, 0.0064814486912252, 0.0065495406378233, 0.0066178785309672, 0.0066864621094228, 0.0067552911064693, 0.0068243652499425, 0.0068936842622792, 0.0069632478605615, 0.0070330557565615, 0.0071031076567854, 0.0071734032625188, 0.0072439422698711, 0.0073147243698209, 0.0073857492482607, 0.0074570165860425, 0.0075285260590226, 0.0076002773381072, 0.0076722700892975, 0.0077445039737357, 0.0078169786477495, 0.0078896937628984, 0.0079626489660187, 0.0080358438992692, 0.0081092782001765, 0.0081829515016804, 0.0082568634321796, 0.0083310136155767, 0.008405401671324, 0.0084800272144682, 0.0085548898556961, 0.0086299892013796, 0.0087053248536204, 0.0087808964102958, 0.0088567034651028, 0.0089327456076032, 0.0090090224232684, 0.0090855334935237, 0.009162278395793, 0.0092392567035429, 0.009316467986327, 0.0093939118098299, 0.0094715877359112, 0.0095494953226491, 0.009627634124384, 0.0097060036917619, 0.009784603571778, 0.0098634333078191, 0.0099424924397072, 0.0100217805037417, 0.0101012970327422, 0.010181041556091, 0.0102610135997747, 0.0103412126864265, 0.0104216383353682, 0.0105022900626511, 0.0105831673810977, 0.0106642698003431, 0.010745596826875, 0.0108271479640753, 0.01090892271226, 0.0109909205687197, 0.0110731410277593, 0.0111555835807379, 0.0112382477161084, 0.0113211329194566, 0.0114042386735406, 0.0114875644583289, 0.0115711097510399, 0.0116548740261792, 0.0117388567555787, 0.0118230574084334, 0.0119074754513398, 0.0119921103483328, 0.0120769615609228, 0.0121620285481324, 0.0122473107665334, 0.0123328076702826, 0.0124185187111581, 0.0125044433385951, 0.0125905809997213, 0.0126769311393922, 0.0127634932002261, 0.012850266622639, 0.0129372508448789, 0.0130244453030602, 0.0131118494311974, 0.0131994626612393, 0.0132872844231018, 0.0133753141447016, 0.0134635512519888, 0.01355199516898, 0.0136406453177902, 0.0137295011186653, 0.0138185619900136, 0.0139078273484381, 0.0139972966087671, 0.0140869691840859, 0.0141768444857673, 0.0142669219235023, 0.0143572009053307, 0.0144476808376708, 0.0145383611253492, 0.0146292411716308, 0.0147203203782478, 0.014811598145429, 0.0149030738719282, 0.0149947469550532, 0.015086616790694, 0.0151786827733508, 0.0152709442961618, 0.0153634007509309, 0.0154560515281549, 0.0155488960170507, 0.0156419336055821, 0.0157351636804863, 0.0158285856273006, 0.0159221988303881, 0.0160160026729636, 0.0161099965371198, 0.0162041798038521, 0.0162985518530838, 0.0163931120636917, 0.0164878598135299, 0.016582794479455, 0.0166779154373499, 0.0167732220621482, 0.0168687137278576, 0.0169643898075837, 0.0170602496735535, 0.0171562926971379, 0.0172525182488755, 0.0173489256984946, 0.0174455144149359, 0.0175422837663746, 0.0176392331202427, 0.0177363618432507, 0.0178336693014091, 0.0179311548600499, 0.0180288178838476, 0.0181266577368407, 0.0182246737824516, 0.0183228653835081, 0.0184212319022629, 0.0185197727004146, 0.0186184871391268, 0.0187173745790486, 0.0188164343803335, 0.0189156659026595, 0.0190150685052473, 0.0191146415468803, 0.0192143843859226, 0.0193142963803379, 0.0194143768877078, 0.0195146252652503, 0.0196150408698372, 0.0197156230580125, 0.0198163711860099, 0.0199172846097699, 0.0200183626849577, 0.0201196047669797, 0.0202210102110009, 0.0203225783719613, 0.0204243086045925, 0.0205262002634344, 0.020628252702851, 0.0207304652770467, 0.0208328373400819, 0.0209353682458893, 0.0210380573482886, 0.0211409040010024, 0.0212439075576715, 0.0213470673718694, 0.0214503827971175, 0.0215538531869, 0.0216574778946781, 0.0217612562739044, 0.0218651876780373, 0.021969271460555, 0.0220735069749694, 0.0221778935748399, 0.0222824306137868, 0.022387117445505, 0.0224919534237773, 0.0225969379024874, 0.0227020702356328, 0.0228073497773379, 0.0229127758818667, 0.0230183479036351, 0.0231240651972235, 0.0232299271173892, 0.0233359330190782, 0.0234420822574374, 0.0235483741878264, 0.0236548081658294, 0.0237613835472663, 0.0238680996882046, 0.0239749559449705, 0.0240819516741601, 0.0241890862326504, 0.0242963589776103, 0.0244037692665112, 0.0245113164571378, 0.0246189999075985, 0.0247268189763359, 0.024834773022137, 0.0249428614041433, 0.0250510834818609, 0.0251594386151702, 0.0252679261643359, 0.0253765454900164, 0.0254852959532737, 0.0255941769155822, 0.0257031877388387, 0.0258123277853709, 0.0259215964179469, 0.026030992999784, 0.0261405168945574, 0.0262501674664091, 0.0263599440799564, 0.0264698461003004, 0.0265798728930344, 0.0266900238242519, 0.0268002982605553, 0.0269106955690634, 0.0270212151174197, 0.0271318562738002, 0.0272426184069207, 0.0273535008860451, 0.0274645030809924, 0.0275756243621444, 0.0276868641004529, 0.0277982216674469, 0.0279096964352399, 0.0280212877765367, 0.0281329950646404, 0.0282448176734593, 0.0283567549775134, 0.0284688063519416, 0.0285809711725074, 0.0286932488156061, 0.0288056386582707, 0.0289181400781784, 0.0290307524536567, 0.0291434751636895, 0.0292563075879229, 0.0293692491066714, 0.0294822991009236, 0.0295954569523478, 0.0297087220432981, 0.0298220937568191, 0.0299355714766522, 0.0300491545872407, 0.0301628424737351, 0.030276634521998, 0.0303905301186099, 0.0305045286508738, 0.0306186295068201, 0.030732832075212, 0.0308471357455498, 0.0309615399080759, 0.0310760439537793, 0.0311906472744006, 0.0313053492624358, 0.0314201493111414, 0.0315350468145385, 0.0316500411674171, 0.0317651317653401, 0.0318803180046479, 0.031995599282462, 0.0321109749966895, 0.0322264445460263, 0.0323420073299617, 0.0324576627487819, 0.0325734102035734, 0.0326892490962273, 0.032805178829442, 0.0329211988067278, 0.0330373084324093, 0.0331535071116295, 0.0332697942503527, 0.033386169255368, 0.0335026315342923, 0.0336191804955735, 0.0337358155484936, 0.0338525361031716, 0.0339693415705665, 0.03408623136248, 0.0342032048915597, 0.0343202615713013, 0.0344374008160517, 0.0345546220410116, 0.0346719246622376, 0.0347893080966456, 0.0349067717620122, 0.0350243150769779, 0.0351419374610489, 0.0352596383345999, 0.0353774171188758, 0.0354952732359942, 0.0356132061089473, 0.0357312151616041, 0.0358492998187123, 0.0359674595059005, 0.0360856936496796, 0.0362040016774451, 0.0363223830174786, 0.0364408370989497, 0.0365593633519176, 0.0366779612073327, 0.0367966300970384, 0.0369153694537722, 0.0370341787111675, 0.0371530573037552, 0.0372720046669644, 0.0373910202371246, 0.0375101034514661, 0.0376292537481222, 0.0377484705661294, 0.0378677533454291, 0.0379871015268689, 0.0381065145522029, 0.0382259918640933, 0.0383455329061114, 0.0384651371227379, 0.0385848039593644, 0.0387045328622938, 0.0388243232787416, 0.0389441746568357, 0.0390640864456182, 0.0391840580950451, 0.0393040890559875, 0.0394241787802318, 0.0395443267204806, 0.0396645323303527, 0.0397847950643839, 0.0399051143780271, 0.040025489727653, 0.04014592057055, 0.040266406364925, 0.040386946569903, 0.0405075406455277, 0.0406281880527615, 0.0407488882534859, 0.040869640710501, 0.0409904448875261, 0.0411113002491994, 0.041232206261078, 0.0413531623896378, 0.0414741681022737, 0.0415952228672988, 0.041716326153945, 0.041837477432362, 0.0419586761736177, 0.0420799218496974, 0.042201213933504, 0.042322551898857, 0.0424439352204928, 0.0425653633740636, 0.0426868358361373, 0.0428083520841971, 0.0429299115966408, 0.0430515138527801, 0.0431731583328403, 0.0432948445179594, 0.0434165718901878, 0.0435383399324873, 0.0436601481287302, 0.0437819959636992, 0.043903882923086, 0.0440258084934907, 0.0441477721624212, 0.0442697734182919, 0.0443918117504229, 0.0445138866490395, 0.0446359976052705, 0.044758144111148, 0.0448803256596058, 0.0450025417444784, 0.0451247918605004, 0.045247075503305, 0.0453693921694227, 0.0454917413562807, 0.0456141225622013, 0.0457365352864009, 0.0458589790289886, 0.0459814532909649, 0.0461039575742209, 0.0462264913815363, 0.0463490542165785, 0.0464716455839013, 0.0465942649889432, 0.0467169119380262, 0.0468395859383544, 0.0469622864980124, 0.047085013125964, 0.0472077653320505, 0.0473305426269895, 0.0474533445223729, 0.0475761705306657, 0.0476990201652044, 0.0478218929401953, 0.0479447883707127, 0.0480677059726976, 0.0481906452629558, 0.0483136057591562, 0.0484365869798295, 0.0485595884443657, 0.0486826096730131, 0.0488056501868762, 0.0489287095079138, 0.0490517871589376, 0.0491748826636098, 0.0492979955464419, 0.0494211253327925, 0.0495442715488654, 0.0496674337217077, 0.0497906113792082, 0.0499138040500951, 0.0500370112639343, 0.0501602325511273, 0.0502834674429094, 0.0504067154713476, 0.0505299761693385, 0.0506532490706065, 0.0507765337097019, 0.0508998296219983, 0.0510231363436911, 0.0511464534117951, 0.0512697803641427, 0.0513931167393815, 0.0515164620769725, 0.0516398159171877, 0.0517631778011082, 0.0518865472706218, 0.0520099238684212, 0.0521333071380015, 0.0522566966236583, 0.0523800918704852, 0.052503492424372, 0.0526268978320021, 0.0527503076408506, 0.0528737213991818, 0.0529971386560472, 0.0531205589612833, 0.0532439818655089, 0.0533674069201234, 0.0534908336773041, 0.0536142616900044, 0.053737690511951, 0.0538611196976418, 0.0539845488023438, 0.0541079773820906, 0.0542314049936801, 0.0543548311946722, 0.0544782555433866, 0.0546016775989002, 0.054725096921045, 0.0548485130704058, 0.0549719256083176, 0.0550953340968636, 0.0552187380988724, 0.0553421371779161, 0.0554655308983078, 0.0555889188250989, 0.0557123005240773, 0.0558356755617646, 0.055959043505414, 0.0560824039230076, 0.0562057563832545, 0.056329100455588, 0.0564524357101634, 0.0565757617178556, 0.0566990780502568, 0.0568223842796738, 0.0569456799791262, 0.0570689647223435, 0.0571922380837627, 0.0573154996385266, 0.0574387489624803, 0.0575619856321701, 0.0576852092248399, 0.0578084193184298, 0.0579316154915731, 0.0580547973235942, 0.0581779643945062, 0.0583011162850083, 0.0584242525764839, 0.0585473728509978, 0.0586704766912939, 0.0587935636807932, 0.0589166334035909, 0.0590396854444545, 0.0591627193888211, 0.0592857348227954, 0.059408731333147, 0.0595317085073084, 0.0596546659333725, 0.0597776032000901, 0.059900519896868, 0.0600234156137661, 0.0601462899414958, 0.0602691424714172, 0.0603919727955367, 0.0605147805065051, 0.0606375651976151, 0.0607603264627992, 0.060883063896627, 0.0610057770943034, 0.0611284656516659, 0.061251129165183, 0.0613737672319511, 0.061496379449693, 0.0616189654167552, 0.0617415247321059, 0.0618640569953328, 0.0619865618066406, 0.0621090387668493, 0.0622314874773916, 0.0623539075403108, 0.0624762985582588, 0.0625986601344936, 0.0627209918728776, 0.0628432933778751, 0.0629655642545504, 0.0630878041085653, 0.0632100125461776, 0.0633321891742383, 0.0634543336001901, 0.0635764454320649, 0.0636985242784821, 0.0638205697486461, 0.0639425814523445, 0.0640645589999463, 0.0641865020023993, 0.0643084100712286, 0.0644302828185344, 0.0645521198569898, 0.0646739207998391, 0.064795685260896, 0.064917412854541, 0.0650391031957202, 0.0651607558999426, 0.0652823705832791, 0.0654039468623596, 0.065525484354372, 0.0656469826770595, 0.0657684414487195, 0.0658898602882012, 0.066011238814904, 0.0661325766487755, 0.0662538734103099, 0.066375128720546, 0.0664963422010656, 0.0666175134739915, 0.0667386421619859, 0.0668597278882487, 0.0669807702765156, 0.0671017689510564, 0.0672227235366734, 0.0673436336586996, 0.0674644989429973, 0.067585319015956, 0.0677060935044908, 0.0678268220360414, 0.0679475042385696, 0.0680681397405582, 0.0681887281710094, 0.0683092691594431, 0.0684297623358954, 0.068550207330917, 0.0686706037755716, 0.0687909513014345, 0.0689112495405914, 0.0690314981256361, 0.0691516966896698, 0.0692718448662995, 0.069391942289636, 0.0695119885942933, 0.0696319834153866, 0.0697519263885311, 0.0698718171498407, 0.0699916553359265, 0.0701114405838956, 0.0702311725313494, 0.0703508508163829, 0.0704704750775828, 0.0705900449540267, 0.0707095600852814, 0.0708290201114019, 0.0709484246729301, 0.0710677734108937, 0.0711870659668047, 0.0713063019826586, 0.0714254811009329, 0.0715446029645859, 0.0716636672170559, 0.07178267350226, 0.0719016214645925, 0.0720205107489245, 0.0721393410006023, 0.0722581118654466, 0.0723768229897515, 0.0724954740202831, 0.0726140646042788, 0.0727325943894463, 0.0728510630239626, 0.0729694701564728, 0.0730878154360893, 0.0732060985123912, 0.0733243190354225, 0.0734424766556922, 0.0735605710241729, 0.0736786017922997, 0.0737965686119699, 0.0739144711355417, 0.0740323090158335, 0.0741500819061234, 0.0742677894601479, 0.0743854313321012, 0.0745030071766349, 0.0746205166488567, 0.07473795940433, 0.0748553350990729, 0.0749726433895579, 0.0750898839327107, 0.0752070563859099, 0.0753241604069861, 0.0754411956542217, 0.0755581617863496, 0.075675058462553, 0.0757918853424648, 0.0759086420861669, 0.0760253283541896, 0.0761419438075112, 0.0762584881075572, 0.0763749609162001, 0.0764913618957585, 0.0766076907089971, 0.0767239470191257, 0.0768401304897989, 0.0769562407851159, 0.0770722775696197, 0.0771882405082969, 0.0773041292665772, 0.0774199435103328, 0.0775356829058785, 0.0776513471199708, 0.0777669358198079, 0.0778824486730292, 0.077997885347715, 0.078113245512386, 0.0782285288360035, 0.0783437349879684, 0.0784588636381214, 0.0785739144567429, 0.0786888871145519, 0.0788037812827069, 0.0789185966328045, 0.0790333328368803, 0.0791479895674078, 0.0792625664972986, 0.0793770632999023, 0.0794914796490062, 0.0796058152188351, 0.0797200696840511, 0.0798342427197538, 0.0799483340014797};
        static double[] expectedFromComsol = new double[]
        {0.0007129565223671997, 0.0010666609276386, 0.0014182726753743, 0.0017679034690053, 0.0021155406016867, 0.0024612345221367, 0.0028050506063947, 0.0031470540006927, 0.0034873053358745, 0.0038258599357506, 0.0041627680836797, 0.0044980755555751, 0.00483182417161, 0.0051640522969102, 0.0054947952781904, 0.0058240858200981, 0.0061519543090138, 0.0064784290921262, 0.0068035367186388, 0.0071273021488608, 0.0074497489359541, 0.007770899384284, 0.0080907746876537, 0.0084093950501547, 0.0087267797919301, 0.0090429474417821, 0.0093579158182686, 0.0096717021006885, 0.0099843228911607, 0.0102957942688366, 0.010606131837152, 0.0109153507649102, 0.0112234658218934, 0.0115304914096227, 0.0118364415878148, 0.0121413300970322, 0.0124451703779684, 0.0127479755877707, 0.0130497586137648, 0.0133505320849105, 0.0136503083812897, 0.0139490996418993, 0.0142469177709986, 0.0145437744432343, 0.014839681107749, 0.0151346489914548, 0.0154286891016381, 0.0157218122280411, 0.0160140289445498, 0.0163053496106028, 0.0165957843724192, 0.0168853431641316, 0.0171740357088945, 0.0174618715200298, 0.0177488599022583, 0.0180350099530554, 0.0183203305641626, 0.0186048304232753, 0.0188885180159237, 0.0191714016275538, 0.0194534893458128, 0.0197347890630368, 0.0200153084789357, 0.0202950551034669, 0.020574036259886, 0.020852259087962, 0.0211297305473407, 0.0214064574210431, 0.0216824463190791, 0.0219577036821623, 0.0222322357855078, 0.022506048742697, 0.0227791485095935, 0.023051540888294, 0.0233232315311012, 0.0235942259445029, 0.0238645294931471, 0.0241341474037992, 0.0244030847692716, 0.0246713465523166, 0.0249389375894722, 0.0252058625948549, 0.0254721261638918, 0.0257377327769859, 0.0260026868031099, 0.0262669925033245, 0.0265306540342171, 0.0267936754512583, 0.0270560607120737, 0.02731781367963, 0.0275789381253333, 0.0278394377320396, 0.0280993160969769, 0.0283585767345796, 0.0286172230792343, 0.0288752584879389, 0.0291326862428763, 0.0293895095539022, 0.0296457315609502, 0.0299013553363544, 0.0301563838870927, 0.0304108201569502, 0.0306646670286079, 0.030917927325655, 0.0311706038145302, 0.0314226992063917, 0.0316742161589183, 0.0319251572780458, 0.0321755251196373, 0.0324253221910925, 0.0326745509528966, 0.0329232138201111, 0.0331713131638087, 0.0334188513124541, 0.0336658305532325, 0.0339122531333286, 0.0341581212611561, 0.0344034371075419, 0.0346482028068651, 0.0348924204581523, 0.0351360921261327, 0.0353792198422527, 0.0356218056056524, 0.0358638513841055, 0.0361053591149239, 0.036346330705829, 0.0365867680357893, 0.0368266729558283, 0.0370660472898017, 0.0373048928351458, 0.037543211363599, 0.0377810046218965, 0.0380182743324397, 0.0382550221939415, 0.038491249882048, 0.0387269590499386, 0.0389621513289039, 0.0391968283289031, 0.0394309916391025, 0.0396646428283945, 0.0398977834458983, 0.0401304150214439, 0.0403625390660391, 0.04059415707232, 0.0408252705149876, 0.0410558808512278, 0.0412859895211192, 0.0415155979480258, 0.0417447075389778, 0.0419733196850394, 0.0422014357616648, 0.0424290571290426, 0.0426561851324296, 0.0428828211024733, 0.0431089663555248, 0.0433346221939421, 0.0435597899063834, 0.0437844707680918, 0.0440086660411715, 0.044232376974855, 0.0444556048057636, 0.0446783507581587, 0.0449006160441869, 0.0451224018641172, 0.0453437094065723, 0.0455645398487522, 0.0457848943566524, 0.0460047740852759, 0.0462241801788385, 0.0464431137709701, 0.0466615759849086, 0.0468795679336904, 0.0470970907203348, 0.0473141454380239, 0.0475307331702778, 0.0477468549911253, 0.0479625119652702, 0.0481777051482539, 0.0483924355866132, 0.0486067043180346, 0.0488205123715052, 0.0490338607674596, 0.0492467505179231, 0.0494591826266521, 0.049671158089271, 0.0498826778934057, 0.0500937430188146, 0.0503043544375161, 0.0505145131139139, 0.0507242200049191, 0.0509334760600694, 0.051142282221647, 0.0513506394247922, 0.0515585485976162, 0.0517660106613109, 0.0519730265302562, 0.0521795971121258, 0.0523857233079904, 0.0525914060124188, 0.0527966461135777, 0.0530014444933287, 0.0532058020273242, 0.0534097195851008, 0.0536131980301716, 0.0538162382201166, 0.0540188410066711, 0.0542210072358129, 0.054422737747848, 0.0546240333774943, 0.0548248949539646, 0.0550253233010473, 0.0552253192371864, 0.0554248835755598, 0.0556240171241565, 0.0558227206858523, 0.0560209950584842, 0.0562188410349243, 0.0564162594031513, 0.056613250946322, 0.0568098164428411, 0.0570059566664295, 0.057201672386193, 0.057396964366688, 0.0575918333679878, 0.0577862801457468, 0.0579803054512648, 0.0581739100315489, 0.0583670946293761, 0.0585598599833537, 0.0587522068279796, 0.058944135893701, 0.0591356479069732, 0.0593267435903167, 0.0595174236623739, 0.0597076888379648, 0.0598975398281423, 0.060086977340246, 0.0602760020779562, 0.0604646147413463, 0.0606528160269347, 0.0608406066277364, 0.0610279872333136, 0.0612149585298251, 0.0614015212000761, 0.0615876759235663, 0.061773423376538, 0.0619587642320232, 0.0621436991598902, 0.0623282288268896, 0.0625123538966995, 0.0626960750299705, 0.0628793928843695, 0.0630623081146232, 0.0632448213725614, 0.0634269333071592, 0.0636086445645784, 0.0637899557882093, 0.0639708676187111, 0.0641513806940521, 0.0643314956495492, 0.064511213117907, 0.0646905337292564, 0.0648694581111927, 0.0650479868888127, 0.0652261206847522, 0.0654038601192222, 0.0655812058100452, 0.0657581583726901, 0.0659347184203081, 0.0661108865637664, 0.0662866634116831, 0.0664620495704602, 0.066637045644317, 0.0668116522353229, 0.0669858699434296, 0.0671596993665029, 0.0673331411003539, 0.0675061957387705, 0.0676788638735473, 0.0678511460945158, 0.0680230429895747, 0.0681945551447181, 0.0683656831440654, 0.0685364275698891, 0.0687067890026428, 0.0688767680209894, 0.0690463652018279, 0.0692155811203201, 0.0693844163499177, 0.0695528714623879, 0.0697209470278391, 0.0698886436147467, 0.0700559617899777, 0.0702229021188154, 0.0703894651649836, 0.0705556514906707, 0.0707214616565531, 0.0708868962218186, 0.071051955744189, 0.0712166407799427, 0.0713809518839371, 0.0715448896096303, 0.0717084545091026, 0.0718716471330779, 0.0720344680309442, 0.0721969177507747, 0.0723589968393478, 0.072520705842167, 0.0726820453034807, 0.0728430157663015, 0.0730036177724252, 0.0731638518624497, 0.0733237185757934, 0.0734832184507135, 0.0736423520243236, 0.0738011198326119, 0.0739595224104579, 0.0741175602916501, 0.0742752340089025, 0.0744325440938712, 0.0745894910771706, 0.0747460754883898, 0.074902297856108, 0.0750581587079105, 0.0752136585704034, 0.0753687979692294, 0.0755235774290818, 0.0756779974737199, 0.0758320586259827, 0.0759857614078035, 0.0761391063402235, 0.0762920939434058, 0.0764447247366485, 0.0765969992383982, 0.076748917966263, 0.0769004814370252, 0.0770516901666543, 0.0772025446703189, 0.0773530454623994, 0.0775031930564998, 0.0776529879654596, 0.0778024307013653, 0.0779515217755623, 0.0781002616986657, 0.0782486509805717, 0.0783966901304685, 0.0785443796568469, 0.0786917200675109, 0.0788387118695886, 0.0789853555695417, 0.079131651673176, 0.0792776006856516, 0.0794232031114919, 0.0795684594545941, 0.079713370218238, 0.0798579359050958, 0.0800021570172407, 0.0801460340561567, 0.0802895675227468, 0.0804327579173421, 0.0805756057397104, 0.0807181114890646, 0.0808602756640709, 0.0810020987628576, 0.0811435812830223, 0.0812847237216407, 0.081425526575274, 0.0815659903399767, 0.0817061155113044, 0.0818459025843209, 0.081985352053606, 0.0821244644132625, 0.0822632401569236, 0.0824016797777596, 0.0825397837684852, 0.082677552621366, 0.0828149868282257, 0.0829520868804522, 0.0830888532690047, 0.0832252864844196, 0.0833613870168172, 0.0834971553559078, 0.083632591990998, 0.0837676974109967, 0.0839024721044211, 0.0840369165594024, 0.084171031263692, 0.084304816704667, 0.0844382733693357, 0.0845714017443434, 0.0847042023159779, 0.0848366755701746, 0.0849688219925223, 0.085100642068268, 0.0852321362823222, 0.0853633051192642, 0.085494149063347, 0.0856246685985019, 0.0857548642083442, 0.0858847363761771, 0.086014285584997, 0.0861435123174981, 0.0862724170560769, 0.0864010002828366, 0.0865292624795921, 0.0866572041278737, 0.086784825708932, 0.086912127703742, 0.087039110593007, 0.0871657748571635, 0.0872921209763846, 0.0874181494305841, 0.087543860699421, 0.087669255262303, 0.0877943335983901, 0.0879190961865991, 0.0880435435056068, 0.0881676760338538, 0.0882914942495483, 0.0884149986306694, 0.0885381896549707, 0.088661067799984, 0.0887836335430225, 0.0889058873611838, 0.089027829731354, 0.0891494611302103, 0.0892707820342243, 0.0893917929196653, 0.0895124942626033, 0.0896328865389121, 0.0897529702242719, 0.0898727457941729, 0.0899922137239175, 0.0901113744886237, 0.0902302285632273, 0.0903487764224851, 0.0904670185409774, 0.0905849553931105, 0.0907025874531194, 0.0908199151950704, 0.0909369390928634, 0.0910536596202343, 0.0911700772507577, 0.0912861924578488, 0.0914020057147659, 0.0915175174946127, 0.0916327282703402, 0.0917476385147493, 0.0918622487004924, 0.0919765593000756, 0.0920905707858609, 0.0922042836300678, 0.0923176983047754, 0.0924308152819245, 0.0925436350333188, 0.092656158030627, 0.0927683847453848, 0.0928803156489959, 0.0929919512127344, 0.0931032919077455, 0.0932143382050478, 0.0933250905755345, 0.0934355494899747, 0.0935457154190151, 0.093655588833181, 0.0937651702028779, 0.0938744599983926, 0.0939834586898947, 0.0940921667474374, 0.0942005846409588, 0.094308712840283, 0.0944165518151214, 0.0945241020350732, 0.0946313639696268, 0.0947383380881606, 0.0948450248599439, 0.0949514247541375, 0.0950575382397952, 0.0951633657858636, 0.0952689078611837, 0.0953741649344912, 0.0954791374744169, 0.095583825949488, 0.095688230828128, 0.0957923525786576, 0.0958961916692952, 0.0959997485681572, 0.0961030237432585, 0.0962060176625129, 0.0963087307937336, 0.0964111636046331, 0.096513316562824, 0.0966151901358189, 0.0967167847910308, 0.0968181009957731, 0.0969191392172599, 0.0970198999226061, 0.0971203835788274, 0.0972205906528405, 0.0973205216114627, 0.0974201769214126, 0.0975195570493094, 0.0976186624616731, 0.0977174936249244, 0.0978160510053845, 0.097914335069275, 0.0980123462827175, 0.0981100851117338, 0.0982075520222451, 0.0983047474800722, 0.0984016719509348, 0.0984983259004515, 0.0985947097941393, 0.098690824097413, 0.0987866692755851, 0.0988822457938653, 0.0989775541173599, 0.0990725947110712, 0.0991673680398975, 0.099261874568632, 0.0993561147619625, 0.0994500890844707, 0.0995437980006318, 0.0996372419748137, 0.0997304214712762, 0.0998233369541708, 0.0999159888875394, 0.1000083777353142, 0.1001005039613165, 0.1001923680292559, 0.1002839704027301, 0.1003753115452236, 0.1004663919201068, 0.1005572119906357, 0.1006477722199505, 0.1007380730710752, 0.1008281150069163, 0.1009178984902621, 0.1010074239837819, 0.1010966919500249, 0.101185702851419, 0.1012744571502706, 0.1013629553087629, 0.1014511977889551, 0.1015391850527814, 0.1016269175620504, 0.1017143957784431, 0.101801620163513, 0.1018885911786842, 0.1019753092852505, 0.1020617749443747, 0.102147988617087, 0.1022339507642841, 0.1023196618467282, 0.1024051223250457, 0.1024903326597262, 0.1025752933111211, 0.1026600047394427, 0.1027444674047628, 0.1028286817670117, 0.1029126482859771, 0.1029963674213026, 0.1030798396324864, 0.1031630653788808, 0.1032460451196901, 0.10332877931397, 0.1034112684206258, 0.1034935128984118, 0.1035755132059296, 0.1036572698016267, 0.1037387831437959, 0.1038200536905732, 0.1039010818999371, 0.1039818682297072, 0.1040624131375427, 0.1041427170809412, 0.1042227805172375, 0.1043026039036022, 0.1043821876970406, 0.1044615323543908, 0.104540638332323, 0.1046195060873379, 0.1046981360757655, 0.1047765287537636, 0.1048546845773163, 0.1049326040022334, 0.1050102874841481, 0.1050877354785163, 0.1051649484406151, 0.1052419268255412, 0.1053186710882099, 0.1053951816833537, 0.1054714590655206, 0.1055475036890731, 0.1056233160081868, 0.1056988964768488, 0.1057742455488565, 0.1058493636778163, 0.1059242513171422, 0.1059989089200542, 0.1060733369395774, 0.1061475358285401, 0.1062215060395729, 0.106295248025107, 0.106368762237373, 0.1064420491283994, 0.1065151091500115, 0.1065879427538298, 0.1066605503912686, 0.1067329325135347, 0.1068050895716264, 0.1068770220163313, 0.1069487302982258, 0.1070202148676734, 0.1070914761748229, 0.1071625146696081, 0.1072333308017452, 0.1073039250207325, 0.1073742977758483, 0.1074444495161501, 0.1075143806904729, 0.1075840917474278, 0.107653583135401, 0.1077228553025524, 0.1077919086968138, 0.1078607437658882, 0.107929360957248, 0.107997760718134, 0.1080659434955536, 0.1081339097362802, 0.1082016598868512, 0.1082691943935671, 0.1083365137024899, 0.1084036182594421, 0.108470508510005, 0.1085371848995177, 0.108603647873076, 0.1086698978755304, 0.1087359353514855, 0.1088017607452983, 0.1088673745010773, 0.1089327770626805, 0.1089979688737152, 0.1090629503775356, 0.1091277220172425, 0.1091922842356813, 0.1092566374754411, 0.1093207821788535, 0.1093847187879911, 0.1094484477446665, 0.1095119694904309, 0.1095752844665727, 0.109638393114117, 0.1097012958738232, 0.109763993186185, 0.1098264854914282, 0.1098887732295102, 0.1099508568401182, 0.1100127367626685, 0.1100744134363049, 0.1101358872998979, 0.1101971587920432, 0.1102582283510606, 0.1103190964149927, 0.1103797634216042, 0.1104402298083802, 0.1105004960125251, 0.1105605624709617, 0.1106204296203301, 0.110680097896986, 0.1107395677370002, 0.1107988395761571, 0.1108579138499537, 0.1109167909935983, 0.1109754714420096, 0.1110339556298154, 0.1110922439913518, 0.1111503369606615, 0.1112082349714934, 0.1112659384573011, 0.1113234478512415, 0.1113807635861747, 0.1114378860946618, 0.1114948158089646, 0.1115515531610441, 0.1116080985825596, 0.1116644525048679, 0.1117206153590215, 0.1117765875757684, 0.1118323695855505, 0.1118879618185028, 0.1119433647044522, 0.1119985786729167, 0.1120536041531042, 0.1121084415739114, 0.1121630913639229, 0.1122175539514105, 0.1122718297643315, 0.1123259192303282, 0.1123798227767268, 0.1124335408305365, 0.1124870738184483, 0.112540422166834, 0.1125935863017455, 0.1126465666489135, 0.1126993636337471, 0.1127519776813318, 0.1128044092164298, 0.1128566586634779, 0.1129087264465874, 0.1129606129895427, 0.1130123187158005, 0.1130638440484887, 0.1131151894104059, 0.1131663552240197, 0.1132173419114668, 0.1132681498945511, 0.1133187795947433, 0.1133692314331801, 0.1134195058306628, 0.1134696032076569, 0.1135195239842907, 0.113569268580355, 0.1136188374153017, 0.1136682309082431, 0.1137174494779509, 0.1137664935428558, 0.1138153635210457, 0.1138640598302658, 0.113912582887917, 0.1139609331110556, 0.1140091109163919, 0.1140571167202897, 0.1141049509387653, 0.1141526139874868, 0.1142001062817729, 0.1142474282365925, 0.1142945802665634, 0.1143415627859518, 0.1143883762086714, 0.1144350209482824, 0.1144814974179908, 0.1145278060306475, 0.1145739471987475, 0.1146199213344291, 0.1146657288494732, 0.1147113701553019, 0.1147568456629786, 0.1148021557832063, 0.1148473009263274, 0.1148922815023226, 0.1149370979208102, 0.1149817505910451, 0.1150262399219181, 0.1150705663219555, 0.1151147301993174, 0.115158731961798, 0.1152025720168236, 0.115246250771453, 0.1152897686323758, 0.1153331260059121, 0.1153763232980114, 0.1154193609142521, 0.1154622392598406, 0.1155049587396104, 0.1155475197580215, 0.1155899227191594, 0.1156321680267346, 0.1156742560840815, 0.1157161872941578, 0.115757962059544, 0.1157995807824419, 0.1158410438646746, 0.1158823517076852, 0.1159235047125363, 0.115964503279909, 0.1160053478101026, 0.1160460387030331, 0.1160865763582331, 0.1161269611748506, 0.1161671935516487, 0.1162072738870041, 0.1162472025789071, 0.1162869800249604, 0.1163266066223785, 0.1163660827679868, 0.116405408858221, 0.1164445852891261, 0.1164836124563561, 0.1165224907551727, 0.1165612205804449, 0.1165998023266479, 0.116638236387863, 0.116676523157776, 0.116714663029677, 0.1167526563964596, 0.1167905036506199, 0.116828205184256, 0.116865761389067, 0.1169031726563524, 0.1169404393770114, 0.1169775619415421, 0.1170145407400405, 0.1170513761622002, 0.1170880685973113, 0.1171246184342597, 0.1171610260615264, 0.1171972918671869, 0.1172334162389101, 0.1172693995639579, 0.117305242229184, 0.1173409446210339, 0.1173765071255432, 0.1174119301283376, 0.1174472140146319, 0.1174823591692289, 0.1175173659765194, 0.1175522348204807, 0.1175869660846764, 0.1176215601522551, 0.1176560174059502, 0.1176903382280788, 0.1177245230005411, 0.1177585721048197, 0.1177924859219785, 0.1178262648326623, 0.1178599092170959, 0.1178934194550836, 0.117926795926008, 0.1179600390088294, 0.1179931490820855, 0.1180261265238898, 0.1180589717119316, 0.1180916850234749, 0.1181242668353578, 0.1181567175239914, 0.1181890374653596, 0.1182212270350177, 0.1182532866080924, 0.1182852165592802, 0.1183170172628474, 0.1183486890926289, 0.1183802324220275, 0.1184116476240134, 0.118442935071123, 0.1184740951354587, 0.1185051281886875, 0.1185360346020408, 0.1185668147463135, 0.118597468991863, 0.1186279977086086, 0.118658401266031, 0.118688680033171, 0.1187188343786293, 0.1187488646705654, 0.1187787712766969, 0.1188085545642988, 0.1188382149002028, 0.1188677526507963, 0.1188971681820219, 0.1189264618593767, 0.1189556340479111, 0.1189846851122286, 0.1190136154164846, 0.119042425324386, 0.1190711151991901, 0.1190996854037041, 0.1191281363002842, 0.119156468250835, 0.1191846816168085, 0.1192127767592037, 0.1192407540385654, 0.1192686138149838, 0.1192963564480936, 0.1193239822970732, 0.1193514917206442, 0.1193788850770703, 0.1194061627241566, 0.1194333250192491, 0.1194603723192339, 0.119487304980536, 0.1195141233591191, 0.1195408278104847, 0.1195674186896711, 0.1195938963512529, 0.1196202611493401, 0.1196465134375775, 0.1196726535691439, 0.1196986818967513, 0.1197245987726439, 0.1197504045485979, 0.1197760995759205, 0.1198016842054489, 0.1198271587875497, 0.1198525236721186, 0.1198777792085789, 0.1199029257458813, 0.1199279636325028, 0.1199528932164464, 0.1199777148452397, 0.1200024288659348, 0.1200270356251072, 0.1200515354688552, 0.1200759287427991, 0.1201002157920803, 0.1201243969613608, 0.1201484725948225, 0.1201724430361662, 0.1201963086286109, 0.1202200697148934, 0.120243726637267, 0.1202672797375014, 0.1202907293568814, 0.1203140758362066, 0.1203373195157902, 0.1203604607354587, 0.1203834998345511, 0.120406437151918, 0.1204292730259207, 0.120452007794431, 0.1204746417948301, 0.1204971753640079, 0.1205196088383623, 0.1205419425537987, 0.1205641768457289, 0.1205863120490704, 0.1206083484982462, 0.1206302865271835, 0.120652126469313, 0.1206738686575687, 0.1206955134243868, 0.1207170611017047, 0.120738512020961, 0.1207598665130943, 0.1207811249085425, 0.1208022875372422, 0.120823354728628, 0.1208443268116318, 0.120865204114682, 0.1208859869657028, 0.1209066756921137, 0.1209272706208285, 0.1209477720782548, 0.1209681803902932, 0.1209884958823366, 0.1210087188792698, 0.1210288497054682, 0.1210488886847977, 0.1210688361406137, 0.1210886923957604, 0.1211084577725703, 0.1211281325928634, 0.1211477171779463, 0.121167211848612, 0.1211866169251388, 0.1212059327272899, 0.1212251595743125, 0.1212442977849371, 0.1212633476773772, 0.1212823095693283, 0.121301183777967, 0.1213199706199511, 0.1213386704114181, 0.1213572834679851, 0.1213758101047478, 0.1213942506362802, 0.1214126053766335, 0.1214308746393356, 0.1214490587373908, 0.1214671579832787, 0.1214851726889536, 0.1215031031658441, 0.1215209497248523, 0.1215387126763532, 0.1215563923301938, 0.121573988995693, 0.1215915029816405, 0.1216089345962962, 0.12162628414739, 0.1216435519421206, 0.1216607382871551, 0.1216778434886287, 0.1216948678521434, 0.121711811682768, 0.1217286752850372, 0.1217454589629511, 0.1217621630199743, 0.1217787877590357, 0.1217953334825277, 0.1218118004923054, 0.1218281890896865, 0.12184449957545, 0.1218607322498364, 0.1218768874125464, 0.1218929653627409, 0.1219089663990397, 0.1219248908195217, 0.1219407389217239, 0.1219565110026408, 0.1219722073587238, 0.1219878282858808};

        public void EquationsTests13DistributedModelBuilder()
        {
            IsoparametricJacobian3D.DeterminantTolerance = 1e-20;
        }

        private Dictionary<int, Func<double, double>> ProductionFuncsWithoutConstantTerm = new Dictionary<int, Func<double, double>>();
        public Func<double, double> getProductionFuncWithoutConstantTerm(int i)
        {
            //return (double Cox) => -PerOx * Sv * (CiOx - Cox) - Aox * T[i] * Cox / (Cox + Kox);
            return (double Cox) => -PerOx * Sv * Cox; //Linear
        }

        private Dictionary<int, Func<double, double>> ProductionFuncsWithoutConstantTermDerivative = new Dictionary<int, Func<double, double>>();
        public Func<double, double> getProductionFuncWithoutConstantTermDerivative(int i)
        {
            //return (double Cox) => -PerOx * Sv - Aox * T[i] / (Cox + Kox) + Aox * T[i] * Cox * Math.Pow(Cox + Kox, -2);
            return (double Cox) => -PerOx * Sv; //Linear
        }

        [Theory]
        [InlineData("../../../DataFiles/workingTetMesh2185_1Domain.mphtxt")]
        public void SolveEquationCOxNonLinearProduction(string fileName)
        {
            var mesh = new ComsolMeshReader(fileName);

            foreach (var elem in mesh.ElementConnectivity)
            {
                FluidSpeed.Add(elem.Key, new double[] { FluidInit, FluidInit, FluidInit });
                T.Add(elem.Key, 500);
                ProductionFuncsWithoutConstantTerm.Add(elem.Key, getProductionFuncWithoutConstantTerm(elem.Key));
                ProductionFuncsWithoutConstantTermDerivative.Add(elem.Key, getProductionFuncWithoutConstantTermDerivative(elem.Key));
            }
            
            var convectionDiffusionDirichletBC = new List<(BoundaryAndInitialConditionsUtility.BoundaryConditionCase, ConvectionDiffusionDof[], double[][], double[])>()
            {
                (BoundaryAndInitialConditionsUtility.BoundaryConditionCase.TopDirichlet, new ConvectionDiffusionDof[] { ConvectionDiffusionDof.UnknownVariable }, new double[1][]{new double[3] {0.1, 0.1, 0.1}}, new double[] {0.2}),
                (BoundaryAndInitialConditionsUtility.BoundaryConditionCase.RightDirichlet,new ConvectionDiffusionDof[] { ConvectionDiffusionDof.UnknownVariable }, new double[1][]{new double[3] {0.1, 0.1, 0.1}}, new double[] {0.2}),
                (BoundaryAndInitialConditionsUtility.BoundaryConditionCase.BackDirichlet, new ConvectionDiffusionDof[] { ConvectionDiffusionDof.UnknownVariable }, new double[1][]{new double[3] {0.1, 0.1, 0.1}}, new double[] {0.2}),
            };
            var convectionDiffusionNeumannBC = new List<(BoundaryAndInitialConditionsUtility.BoundaryConditionCase, ConvectionDiffusionDof[], double[][], double[])>();

            var nodeIdToMonitor = Utilities.FindNodeIdFromNodalCoordinates(mesh.NodesDictionary, monitorNodeCoords, 1e-4);

            var modelBuilder = new CoxModelBuilder(mesh, FluidSpeed, Dox, Aox, Kox, PerOx, Sv, CiOx, T, CoxInitialCondition, independentLinearSource, null, ProductionFuncsWithoutConstantTerm, ProductionFuncsWithoutConstantTermDerivative, nodeIdToMonitor, coxMonitorDOF, convectionDiffusionDirichletBC, convectionDiffusionNeumannBC);
            var model = modelBuilder.GetModel();
            modelBuilder.AddBoundaryConditions(model);

            var analysisData =  modelBuilder.GetAppropriateSolverAnalyzerAndLog(model, TimeStep, TotalTime, 0, 0);
            var dynamicAnalyzer = (NewmarkDynamicAnalyzer) analysisData.analyzer;
            dynamicAnalyzer.Initialize();
            Console.WriteLine("Solving Cox Non-Linear prod");
            dynamicAnalyzer.Solve();

            int totalNewmarkstepsNum = (int)Math.Truncate(TotalTime / TimeStep);
            var cox = new double[totalNewmarkstepsNum];
            for (int i1 = 0; i1 < totalNewmarkstepsNum; i1++)
            {
                var timeStepResultsLog = dynamicAnalyzer.ResultStorage.Logs[i1];
                cox[i1] = ((DOFSLog)timeStepResultsLog).DOFValues[model.GetNode(nodeIdToMonitor), coxMonitorDOF];
            }

            CSVExporter.ExportVectorToCSV(cox, "../../../Integration/cox_non_linear_nodes_mslv.csv");
            Console.WriteLine("FINISHED solving Cox Non-Linear prod");
            Assert.True(CompareResults(cox));

        }

        private bool CompareResults(double[] solution)
        {
            bool ret = true;
            double tolerance = 1e-1;

            for (var i=0 ; i < Math.Min(expectedLinSolution.Length, solution.Length) ; i++)
            {
                var error = Math.Abs(solution[i] - expectedLinSolution[i]);
                Debug.WriteLine("\n======\nStep " + i);
                Debug.WriteLine("\tExpected   :" + expectedLinSolution[i]);
                Debug.WriteLine("\tCalculated :" + solution[i]);
                Debug.WriteLine("\tError      :" + error);
                if ( error > tolerance)
                {
                    Debug.WriteLine("Wrong result on step "+i+", Error: "+error);
                    ret = false;
                    break;
                }
            }

            return ret;
        }


    }
}
